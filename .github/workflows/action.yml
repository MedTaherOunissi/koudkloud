name: first workflow

on:
  push:

jobs:
  zap-scan-job:
   runs-on: ubuntu-latest
   permissions:
    actions: write
    contents: read
    issues: write

   steps:
    - name: Checkout Code
      uses: actions/checkout@v4

    - name: Run OWASP ZAP Baseline Scan
      uses: zaproxy/action-baseline@v0.10.0
      with:
        target: 'http://www.vulnweb.com/'
        fail_action: false
        cmd_options: '-J report_json.json -r report_html.html -w report_md.md'  # Generate JSON, HTML, Markdown reports

    - name: List Generated Files
      if: always()
      run: ls -lah

    - name: Show Report Contents
      if: always()
      run: |
        echo "=== report_html.html ==="
        cat report_html.html || echo "report_html.html not found"
        echo "=== report_json.json ==="
        cat report_json.json || echo "report_json.json not found"
        echo "=== report_md.md ==="
        cat report_md.md || echo "report_md.md not found"

    - name: Upload ZAP Report
      if: always()
      uses: actions/upload-artifact@v4
      with:
        name: zap-report
        path: |
          report_html.html
          report_json.json
          report_md.md
        retention-days: 7
